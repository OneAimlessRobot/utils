Reflectice debugging: pseudoftp.
Ok. o programa é feito para distribuir um ficheiro a vários clientes, potencialmente em simultâneo. Um cliente connecta-se e começa imediatamente um dowload. quando acaba, é largado automaticamente. Também se podem conectar admins. Os admins gerem e monitorizam o server com comandos. O server é uma struct que contém varios campos introspetivos, uma lista de clientes, stack de clientes a expulsar e uma queue com logs para flushar para um ficheiro. A socket passiva do server é ativada com listen em que o backlog é 1000. a socket  tem flags O_ASYNC e O_NONBLOCK nas opções de fd normais. E FIOASYNC nas ioctl. Tem um inteiro, inicialmente o numero maximo de clientes, mas não está a ser usado. Regista total enviado, ritmo de transferência, n de clientes e admins ativos. Quando inicia, liga 4 threads: Um para aceitar conexoes, um só para atualizar as velocidades, um para kickar clientes e outro para registar logs.